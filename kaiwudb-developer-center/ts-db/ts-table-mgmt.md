---
title: 时序表管理
id: ts-table-mgmt
---

# 时序表管理

时序表用于存储时间序列数据。KaiwuDB 开发者中心支持管理时序表以及表中的字段、标签、权限等元素。

## 时序表

KaiwuDB 开发者中心支持创建、编辑、查看、删除、重命名时序表，向表中写入数据或从表中读取数据，以及为时序表生成 SQL 语句。

### 创建时序表

#### 前提条件

用户是 `admin` 角色成员或拥有所属数据库 CREATE 权限。默认情况下，`root` 用户属于 `admin` 角色。

#### 步骤

如需创建时序表，遵循以下步骤。

1. 在数据库导航区，选择要操作的数据库和模式。
2. 右键单击**时序表**，然后选择**新建时序表**。

    <img src="../../static/kdc/ts-table-create.png" style="zoom: 80%;" />

    系统将自动创建名为 **newtable** 的表，并打开对象窗口。

3. 在**属性**页签，填写表名，表名的最大长度为 128 字节。根据需要设置表的生命周期和描述信息。默认情况下，生命周期为 `0s`， 即数据永不过期。
4. 在**字段**页签，新建至少两个字段，设置字段名称、数据类型、长度、是否非空、默认值和描述信息，字段名的最大长度为 128 字节。第一个字段的数据类型必须为 `timestamp` 或 `timestamptz` 且非空。支持设置的小数点为 3（毫秒）、6（微秒）和9（纳秒）。默认情况下，小数点为 3（毫秒）。实际上，系统会将 `timestamp` 数据类型处理为 `timestamptz` 数据类型。

    <img src="../../static/kdc/ts-table-create-01.png" style="zoom:67%;" />

5. 在**标签**页签添加标签，设置标签名称、数据类型、长度、是否为主标签，是否非空和描述信息，然后单击**保存**。

    ::: warning 说明

    - 每张时序表至少需要设置一个主标签，且主标签必须为非空标签。
    - 标签名暂时不支持中文字符，最大长度为 128 字节。

    :::

    <img src="../../static/kdc/ts-table-create-02.png" style="zoom:67%;" />

6. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

### 编辑时序表

时序表支持以下编辑表操作：

- 添加、修改、删除、重命名字段。更多详细信息，参见[字段](#字段)。
- 添加、修改、删除、重命名主标签之外的其它标签，更多详细信息，参见[标签](#标签)。
- 添加和删除数据。
- 修改表的生命周期和描述信息。

#### 前提条件

- 编辑字段和标签、修改表的生命周期和描述信息：用户是 `admin` 角色成员或拥有目标表的 CREATE 权限。默认情况下，`root` 用户属于 `admin` 角色。
- 写入数据：用户是 `admin` 角色成员或拥有目标表的 INSERT 权限。默认情况下，`root` 用户属于 `admin` 角色。
- 删除数据：用户是 `admin` 角色成员或拥有目标表的 SELECT 和 DELETE 权限。默认情况下，`root` 用户属于 `admin` 角色。

#### 编辑数据

目前，KaiwuDB 开发者中心支持向时序表中添加新数据或者从时序表中删除已有数据。

::: warning 说明

- 系统支持为指定的列写入数据，对于未指定的列，如果该列支持 `NULL` 值，系统将自动插入默认值 `NULL`。如果该列不支持 `NULL` 值，系统将提示 `Null value in column %s violates null-null constraints.`。
- 输入 `TIMESTAMP` 或 `TIMESTAMPTZ` 类型数据时，日期部分需要使用短横线（`-`）、空格（` `）或正斜杠符号（`/`）分割，时间部分需要使用冒号（`:`）分割，支持精确到微秒，例如：`2023-01-25 10:10:10.123`、`2023 01 25 10:10:10.123` 或 `2023/01/25 10:10:10.123`。
- KWDB 支持对具有相同时间戳的数据进行去重处理。默认情况下，后写入的数据会覆盖已存在的具有相同时间戳的数据。用户可通过 `SET CLUSTER SETTING ts.dedup.rule=[ merge | override | discard]` 语句设置数据去重策略。有关详细信息，参见[集群参数配置](../../db-operation/cluster-settings-config.md)

:::

如需编辑时序表中的数据，遵循以下步骤。

1. 在数据库导航区，右键单击需要编辑数据的表，然后选择**编辑数据**。
2. 在**数据**页面，进行以下操作：

    - 单击页面下方的**添加新行**按钮，向表中加入相应的数据。
    - 单击页面下方的**复制当前行**按钮，复制当前行数据。
    - 单击页面下方的**删除行**按钮或者使用 `Alt` + `Delete` 快捷键，删除选中的行数据。

      <img src="../../static/kdc/ts-table-edit.png" style="zoom:67%;" />

3. 如需查看对应的 SQL 语句，单击**生成 SQL 语句**，然后单击**执行**。
4. 如果无需查看 SQL 语句，单击**保存**。

#### 修改生命周期和描述信息

如需修改时序表的生命周期或描述信息，遵循以下步骤。

1. 在数据库导航区，双击需要修改的时序表，或者右键单击需要修改的时序表，然后选择**编辑时序表**。

2. 在属性页签根据需要修改生命周期和描述信息，然后单击**保存**。

    <img src="../../static/kdc/ts-table-edit-meta.png" style="zoom:80%;" />

3. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

### 查看时序表

#### 前提条件

用户是 `admin` 角色成员或拥有目标表的 SELECT 权限。默认情况下，`root` 用户属于 `admin` 角色。

#### 步骤

在数据库导航区，双击需要查看的时序表，即可查看时序表的属性和数据信息。

::: warning 提示

- 如果表中包含大量数据行，可以通过工具栏查看数据的总行数，设置每页显示的行数（默认 100 行），并通过点击第一页、上一页、下一页和最后一页图标来分页查看。
- 设置每页显示行数后，需要点击第一页、上一页、下一页或最后一页图标，以查看生效后的分页效果。

:::

<img src="../../static/kdc/ts-page.png" style="zoom:67%;" />

### 导出数据

#### 前提条件

用户是 `admin` 角色的成员。默认情况下，`root` 用户属于 `admin` 角色。

#### 步骤

如需导出时序表中的数据，遵循以下步骤。

1. 在数据库导航区，右键单击需要导出数据的时序表，然后选择**导出数据**。
2. 在**数据转化**窗口，根据需要设置目标类型和格式、提取行数、导出参数、导出目录等，确认设置后单击**确定**。系统将自动切换到转化进度界面，显示数据导出是否成功以及所用时长。
    <img src="../../static/kdc/ts-table-export.png" style="zoom:67%;" />

### 导入数据

#### 前提条件

用户是 `admin` 角色的成员或者拥有目标表的 INSERT 权限。默认情况下，`root` 用户属于 `admin` 角色。

#### 步骤

如需向时序表中导入数据，遵循以下步骤。

1. 在数据库导航区，右键单击需要导入数据的时序表，然后选择**导入数据**。
2. 在**数据转化**窗口，选择从 CSV 文件导入，设置源端名称、根据需要完成导入设置，然后单击**下一步**。

      <img src="../../static/kdc/ts-table-import.png" style="zoom:67%;" />

3. 在**预览数据导入过程**界面，确认预览数据，然后单击**下一步**。

4. 在**数据加载设置**界面设置数据加载方式、执行过程和打开方式，然后单击**下一步**。

5. 在**检查确认**界面检查导入设置，然后单击**确定**。系统将自动切换到**转化进度**界面，显示数据导入是否成功以及所用时长。

### 生成 SQL 语句

KaiwuDB 开发者中心支持为时序表生成以下 SQL 语句：

- SELECT
- INSERT
- UPDATE
- DELETE
- MERGE
- DDL

如需为时序表生成 SQL 语句，遵循以下步骤。

1. 在数据库导航区，右键单击需要生成 SQL 语句的表，选择**生成 SQL**，然后选择需要生成的 SQL 语句。

2. 在**生成 SQL 语句**窗口，选择是否**使用标准名称**和**紧凑型 SQL**，然后单击**复制**或**关闭**。

    默认情况下，使用标准名称，不使用紧凑型 SQL。
      <img src="../../static/kdc/ts-table-generate-sql.png" style="zoom:67%;" />    

### 删除时序表

#### 前提条件

用户是 `admin` 角色成员或者拥有目标表的 DROP 权限。默认情况下，`root` 用户属于 `admin` 角色。

#### 步骤

如需删除时序表，遵循以下步骤。

1. 在数据库导航区，右键单击需要删除的时序表，然后选择**删除**。

2. 在**删除对象**窗口，单击**是**。

### 重命名时序表

#### 前提条件

用户是 `admin` 角色的成员或者拥有目标表的 DROP 权限及所在数据库的 CREATE 权限。默认情况下，`root` 用户属于 `admin` 角色。

#### 步骤

::: warning 说明
新表名必须唯一，并且遵循[数据库标识符规则](../../sql-reference/sql-identifiers.md)。表名的最大长度为 128 字节。目前，时序表名称不支持中文字符。
:::

如需重命名时序表，遵循以下步骤。

1. 在数据库导航区，右键单击需要重命名的时序表，然后选择**重命名**。
2. 在**重命名**窗口，编辑表名称，然后单击**确定**。

    <img src="../../static/kdc/CDbsbkRtSoc2QHxZVcXceIGwnYc.png" style="zoom:67%;" />

3. 单击页面右下方的保存按钮。
4. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

## 字段

字段页面以表格的形式展示字段名、序号、数据类型、长度、是否非空、默认值和描述信息。

### 前提条件

- 需要添加、修改、删除、重命名字段的时序表不在读写过程中。
- 用户是 `admin` 角色的成员或者拥有目标表 CREATE 权限。默认情况下，`root` 用户属于 `admin` 角色。

### 创建字段

::: warning 说明
目前，字段名称暂时不支持中文字符，且不能与已有字段和标签重名。字段名的最大长度为 128 字节。
:::

如需为时序表添加字段，遵循以下步骤。

1. 单击**字段**页面右下角的**新建字段**按钮，或者右键单击**字段**页面空白处，然后选择**新建字段**。

    <img src="../../static/kdc/ts-table-add-field.png" style="zoom:67%;" />

2. 在**编辑属性**窗口，编辑字段名称、数据类型、长度、是否非空、默认值以及字段描述，然后单击**确定**。

    <img src="../../static/kdc/ts-table-add-column.png" style="zoom:67%;" />

3. 单击页面右下方的保存按钮。
4. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

### 修改字段属性

目前，时序表支持修改字段的数据类型、长度、默认值和描述信息。

:::warning 说明

- 转换后的数据类型长度必须大于原数据类型的长度，如 `INT4` 可以转换为 `INT8`，但不能转换为 `INT2`，`CHAR(200)` 可以转为 `VARCHAR(254)`，但不能转为 `VARCHAR(100)`。
- CHAR、VARCHAR、NCHAR 和 NVARCHAR 字符类型支持同数据类型的长度转换，但只能增加长度不能降低长度，例如 `CHAR(100)` 可以转换成 `CHAR(200)`, 不能转换为 `CHAR(50)`。
- 数值类型转字符类型和字符类型间转换需满足特殊要求。更多信息，参见[时序数据类型](../../sql-reference/data-type/data-type-ts-db.md)。
- 修改数据类型时，如果已有数值与新数据类型不匹配，修改操作仍然可以执行成功，不符合新数据类型的数值在查询时将显示为 `NULL`。

:::

如需修改时序表的字段，遵循以下步骤。

1. 在数据库导航区，双击需要修改的时序表。

2. 如需更改数据类型，在**字段**页面，单击需要修改字段的数据类型信息，然后在下拉菜单中，选择新的数据类型。

    <img src="../../static/kdc/ts-table-alter-type.png" style="zoom:67%;" />

3. 如需修改同数据类型的长度，单击需要修改字段的长度值，然后输入新数值。

4. 如需修改字段的默认值，单击需要修改字段的默认值，然后输入新数值。非时间类型的字段，默认值只能是常量。时间类型的字段，默认值可以是常量，也可以是 now() 函数。

5. 如需修改字段的描述信息，单击需要修改字段的描述框，然后输入字段描述。

6. 单击页面右下方的保存按钮。

7. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

### 删除字段

如需删除时序表的字段，遵循以下步骤。

1. 在数据库导航区，双击需要修改的时序表。
2. 在**字段**页面，右键单击需要删除的字段，然后选择**删除**。

    <img src="../../static/kdc/ts-table-delete-field.png" style="zoom:67%;" />

3. 单击页签右下方的保存按钮。
4. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

### 重命名字段

::: warning 说明
目前，新字段名称暂时不支持中文字符，且不能与已有字段和标签重名。字段名的最大长度为 128 字节。
:::

如需重命名时序表的字段，遵循以下步骤。

1. 在数据库导航区，双击需要修改的时序表。
2. 在**字段**页面，双击需要重命名的字段。
3. 在字段的属性页面，编辑字段名称。

    <img src="../../static/kdc/ts-table-rename-field.png" style="zoom:67%;" />

4. 单击页面右下方的保存按钮。
5. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

## 标签

标签页面以表格的形式展示标签名、数据类型、长度、是否为主标签以及是否非空信息。

### 前提条件

- 添加、修改、删除、重命名标签
  - 需要添加、修改标签的时序表不在读写过程中。
  - 用户是 `admin` 角色的成员或者拥有目标表的 CREATE 权限。默认情况下，`root` 用户属于 `admin` 角色。
- 查看标签值：用户是 `admin` 角色的成员或者拥有目标表的 SELECT 权限。默认情况下，`root` 用户属于 `admin` 角色。
- 修改标签值：用户是 `admin` 角色的成员或者拥有目标表的 UPDATE 和 SELECT 权限。默认情况下，`root` 用户属于 `admin` 角色。
- 导出标签数据：用户是 `admin` 角色的成员。默认情况下，`root` 用户属于 `admin` 角色。
- 导入标签数据：用户是 `admin` 角色的成员。默认情况下，`root` 用户属于 `admin` 角色。

### 创建标签

::: warning 说明

- 时序表不支持添加主标签和非空标签。
- 标签名暂时不支持中文字符，最大长度为 128 字节。

:::

如需为时序表添加标签，遵循以下步骤。

1. 在数据库导航区，双击需要修改的时序表。
2. 在**标签**页面，单击右下角**新建标签**按钮，或者右键单击**标签**页面空白处，然后选择**新建标签**。

    <img src="../../static/kdc/ts-add-tag-0.png" style="zoom:67%;" />

3. 在**标签**窗口，编辑标签名称和属性信息，然后单击**确定**。

    <img src="../../static/kdc/ts-add-tag.png" style="zoom:50%;" />

4. 单击页面右下方的保存按钮。
5. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

### 查看标签值

如需查看时序表的标签值，遵循以下步骤。

1. 在数据库导航区，双击需要查看标签的时序表。

2. 在**标签**页面，双击任一标签。

3. 在标签的**数据**页签，即可查看所有标签值。

    <img src="../../static/kdc/ts-show-tag-value.png" style="zoom:67%;" />

### 修改标签属性

KaiwuDB 开发者中心支持修改标签的数据类型、长度和描述信息。

:::warning 说明

- 转换后的数据类型长度必须大于原数据类型的长度，如 `INT4` 可以转换为 `INT8`，但不能转换为 `INT2`，`CHAR(200)` 可以转为 `VARCHAR(254)`，但不能转为 `VARCHAR(100)`。
- CHAR、VARCHAR、NCHAR 和 NVARCHAR 字符类型支持同数据类型的长度转换，但只能增加长度不能降低长度，例如 `CHAR(100)` 可以转换成 `CHAR(200)`, 不能转换为 `CHAR(50)`。
- 数值类型转字符类型和字符类型间转换需满足特殊要求。更多信息，参见[时序数据类型](../../sql-reference/data-type/data-type-ts-db.md)。
- 修改数据类型时，如果已有标签的值与新数据类型不匹配，修改操作仍然可以执行成功，不符合新数据类型的标签值在查询时将显示为 `NULL`。
:::

如需修改标签的数据类型、长度或描述信息，遵循以下步骤。

1. 在数据库导航区，双击需要修改的时序表。

2. 如需更改数据类型，在**标签**页面，单击需要修改标签的数据类型信息，然后在下拉菜单中，选择新的数据类型。

    <img src="../../static/kdc/ts-alter-tag-1.png" style="zoom:67%;" />

3. 如需修改同数据类型的长度，单击需要修改的长度值，然后输入新数值。

4. 如需修改标签的描述信息，单击需要修改的描述框，然后输入字段描述。

5. 单击页面右下方的保存按钮。

6. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

### 编辑标签值

::: warning 说明
时序表不支持修改主标签。
:::

如需修改时序表的标签值，遵循以下步骤。

1. 在数据库导航区，双击需要修改标签值的时序表标签。
2. 在**数据**页面，进行以下操作：

    - 修改标签值：双击需要修改的标签值，输入拟修改的值。
    - 添加标签值：单击页面下方的**添加新行**按钮，即可为所有标签添加新的标签值。如果新写入的主标签值与已有主标签值相同，系统只保留首次写入的主标签和普通标签值。
    - 删除标签值：单击页面下方的**删除行**按钮或者使用 `Alt` + `Delete` 快捷键，删除指定行的所有标签值。删除标签值后，标签值对应的数据列数据也会一同删除。

      ![](../../static/kdc/update-tag-value.png)

3. 如需查看对应的 SQL 语句，单击**生成 SQL 语句**，然后单击**执行**。
4. 如果无需查看 SQL 语句，单击**保存**。

### 删除标签

::: warning 说明
时序表不支持删除主标签。
:::

如需删除时序表的标签，遵循以下步骤。

1. 在数据库导航区，双击需要修改的时序表。
2. 在**标签**页面，右键单击需要删除的标签，然后选择**删除**。
3. 单击页面右下方的保存按钮。
4. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

### 重命名标签

::: warning 说明

- 时序表不支持重命名主标签。
- 新标签名称暂不支持中文字符，且不能与已有标签或字段重名。
- 新标签名的最大长度为 128 字节。

:::

如需重命名时序表的标签，遵循以下步骤。

1. 在数据库导航区，双击需要修改的时序表。
2. 在**标签**页面，右键单击需要重命名的标签，然后选择**重命名**。
3. 在**重命名**窗口，编辑标签名称，然后单击**确定**。

    <img src="../../static/kdc/VCTAb7TExonXr5xw3FXc9vW6nTh.png" style="zoom:67%;" />

4. 单击页面右下方的保存按钮。
5. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

### 导出标签数据

时序表只支持导出表内的标签数据。

如需导出时序表的数据，遵循以下步骤。

1. 在数据库导航区，双击需要导出数据的时序表。
2. 右键单击需要导出标签数据的任一标签，然后选择**导出数据**。
3. 在**数据转化**窗口，根据需要设置目标类型和格式、提取行数、导出参数、导出目录等，确认设置后单击**确定**。系统将自动切换到转化进度界面，显示数据导出是否成功以及所用时长。

    <img src="../../static/kdc/ts-table-export.png" style="zoom:67%;" />

### 导入标签数据

如需向时序表中导入数据，遵循以下步骤。

1. 在数据库导航区，双击需要导入数据的时序表。
2. 右键单击需要导入标签数据的任一标签，然后选择**导入数据**。
3. 在**数据转化**窗口，选择从 CSV 文件导入，设置源端名称、根据需要完成导入设置，然后单击**下一步**。
      <img src="../../static/kdc/ts-table-import.png" style="zoom:67%;" />

4. 在**预览数据导入过程**界面，确认预览数据，然后单击**下一步**。

5. 在**数据加载设置**界面设置数据加载方式、执行过程和打开方式，然后单击**下一步**。

6. 在**检查确认**界面检查导入设置，然后单击**确定**。系统将自动切换到**转化进度**界面，显示数据导入是否成功以及所用时长。

## 权限管理

权限管理用于赋予不同用户指定表的相关权限。

### 前提条件

用户是 `admin` 角色的成员或者拥有目标表 GRANT 和相应的权限。默认情况下，`root` 用户属于 `admin` 角色。

### 赋予权限

如需为用户赋予权限，遵循以下步骤。

1. 在指定表的对象窗口，单击**权限**页签，打开指定表的权限页面。
2. 选择需要授权的用户，勾选相应的权限。

    <img src="../../static/kdc/grant.png" style="zoom:67%;" />

3. 单击页面右下方的保存按钮。
4. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

### 撤销权限

如需撤销用户权限，遵循以下步骤。

1. 在指定表的对象窗口，单击**权限**页签，打开指定表的权限页面。
2. 选择需要撤销授权的用户，取消勾选相应的权限。

    <img src="../../static/kdc/grant.png" style="zoom:67%;" />

3. 单击页面右下方的保存按钮。
4. 在**执行修改**窗口，确认 SQL 语句无误，然后单击**执行**。

## 查看 DDL 语句

在指定表的对象窗口，单击 **DDL** 页签，即可查看相关语句。用户可以按需选择是否显示权限和注释。

<img src="../../static/kdc/ts-table-ddl.png" style="zoom:67%;" />
